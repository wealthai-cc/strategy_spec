# WealthAI Python SDK å®æ–½å®ŒæˆæŠ¥å‘Š

## ğŸ“‹ å®æ–½æ¦‚è§ˆ

âœ… **å·²å®Œæˆ**ï¼šPython SDK è§„èŒƒçš„å®Œæ•´å®ç°  
ğŸ“… **å®Œæˆæ—¶é—´**ï¼š2025-12-16  
ğŸ¯ **çŠ¶æ€**ï¼šæ‰€æœ‰æ ¸å¿ƒåŠŸèƒ½å·²å®ç°å¹¶å¯ç”¨

---

## ğŸ—ï¸ å®æ–½çš„ç»„ä»¶

### 1. æ ¸å¿ƒæ¨¡å—ç»“æ„
```
wealthai_sdk/
â”œâ”€â”€ __init__.py          # ä¸»å…¥å£ï¼Œå¯¼å‡ºæ‰€æœ‰å…¬å…±æ¥å£
â”œâ”€â”€ trading.py           # äº¤æ˜“è§„åˆ™å’Œä½£é‡‘è´¹ç‡æŸ¥è¯¢
â”œâ”€â”€ data_utils.py        # DataFrame è½¬æ¢å·¥å…·
â”œâ”€â”€ config.py            # é…ç½®ç®¡ç†
â””â”€â”€ exceptions.py        # å¼‚å¸¸å®šä¹‰
```

### 2. å®ç°çš„æ¥å£

#### âœ… `get_trading_rule(broker, symbol)`
- **åŠŸèƒ½**ï¼šæŸ¥è¯¢äº¤æ˜“è§„åˆ™ï¼ˆæœ€å°æ•°é‡ã€ä»·æ ¼ç²¾åº¦ã€æ æ†é™åˆ¶ç­‰ï¼‰
- **ç¼“å­˜**ï¼šæŒ‰ `broker+symbol` ç¼“å­˜ï¼Œå¾®ç§’çº§å“åº”
- **å¼‚å¸¸å¤„ç†**ï¼šNotFoundError, ParseError
- **çº¿ç¨‹å®‰å…¨**ï¼šä½¿ç”¨ RLock ä¿è¯å¹¶å‘å®‰å…¨

#### âœ… `get_commission_rates(broker, symbol)`  
- **åŠŸèƒ½**ï¼šæŸ¥è¯¢ Maker/Taker ä½£é‡‘è´¹ç‡
- **ç¼“å­˜**ï¼šåŒæ ·çš„ç¼“å­˜æœºåˆ¶
- **ç”¨é€”**ï¼šäº¤æ˜“æˆæœ¬è®¡ç®—å’Œç­–ç•¥æ”¶ç›Šè¯„ä¼°

#### âœ… `bars_to_dataframe(bars)`
- **åŠŸèƒ½**ï¼šå°† Bar å¯¹è±¡è½¬æ¢ä¸º pandas DataFrame
- **æ”¯æŒæ ¼å¼**ï¼šå¯¹è±¡å’Œå­—å…¸ä¸¤ç§ Bar æ ¼å¼
- **ç”¨é€”**ï¼šæ”¯æŒ wealthdata å…¼å®¹å±‚

### 3. é…ç½®ç³»ç»Ÿ

#### âœ… é…ç½®ç›®å½•ä¼˜å…ˆçº§
1. ç¯å¢ƒå˜é‡ `WEALTHAI_CONFIG_DIR`
2. é¡¹ç›®æ ¹ç›®å½• `config/`  
3. ç”¨æˆ·ç›®å½• `~/.wealthai/`

#### âœ… é…ç½®æ–‡ä»¶ç»“æ„
```
config/
â”œâ”€â”€ trading_rules/
â”‚   â””â”€â”€ binance.json     # äº¤æ˜“è§„åˆ™é…ç½®
â”œâ”€â”€ commission_rates/
â”‚   â””â”€â”€ binance.json     # ä½£é‡‘è´¹ç‡é…ç½®
â””â”€â”€ README.md            # é…ç½®è¯´æ˜
```

### 4. æµ‹è¯•å’Œç¤ºä¾‹

#### âœ… å•å…ƒæµ‹è¯• (`tests/test_wealthai_sdk.py`)
- æµ‹è¯•æ‰€æœ‰æ ¸å¿ƒåŠŸèƒ½
- æ¨¡æ‹Ÿé…ç½®æ–‡ä»¶
- å¼‚å¸¸å¤„ç†æµ‹è¯•
- ç¼“å­˜æœºåˆ¶æµ‹è¯•

#### âœ… ä½¿ç”¨ç¤ºä¾‹ (`examples/sdk_usage_example.py`)
- å®Œæ•´çš„ä½¿ç”¨æ¼”ç¤º
- é”™è¯¯å¤„ç†ç¤ºä¾‹
- å®é™…åº”ç”¨åœºæ™¯

---

## ğŸ¯ ç¬¦åˆè§„èŒƒç¨‹åº¦

### âœ… å®Œå…¨ç¬¦åˆ OpenSpec è§„èŒƒ

| è§„èŒƒè¦æ±‚ | å®æ–½çŠ¶æ€ | è¯´æ˜ |
|---------|---------|------|
| **æœ¬åœ°æŸ¥è¯¢** | âœ… å®Œæˆ | æ‰€æœ‰æ¥å£é€šè¿‡æœ¬åœ°æ–‡ä»¶è¯»å– |
| **é«˜æ€§èƒ½** | âœ… å®Œæˆ | æ¯«ç§’çº§å“åº”ï¼Œç¼“å­˜åå¾®ç§’çº§ |
| **çº¿ç¨‹å®‰å…¨** | âœ… å®Œæˆ | ä½¿ç”¨ RLock ä¿è¯å¹¶å‘å®‰å…¨ |
| **ç¼“å­˜æœºåˆ¶** | âœ… å®Œæˆ | æŒ‰ `broker+symbol` ç¼“å­˜ |
| **å¼‚å¸¸å¤„ç†** | âœ… å®Œæˆ | NotFoundError, ParseError |
| **DataFrame æ”¯æŒ** | âœ… å®Œæˆ | bars_to_dataframe å‡½æ•° |

### âœ… æ¥å£ç­¾åå®Œå…¨åŒ¹é…
```python
# è§„èŒƒè¦æ±‚çš„æ¥å£
def get_trading_rule(broker: str, symbol: str) -> dict
def get_commission_rates(broker: str, symbol: str) -> dict  
def bars_to_dataframe(bars) -> pd.DataFrame

# âœ… å®é™…å®ç°å®Œå…¨åŒ¹é…
```

### âœ… è¿”å›æ•°æ®ç»“æ„å®Œå…¨ç¬¦åˆ
- äº¤æ˜“è§„åˆ™åŒ…å«æ‰€æœ‰å¿…éœ€å­—æ®µï¼ˆsymbol, min_quantity, price_precision ç­‰ï¼‰
- ä½£é‡‘è´¹ç‡åŒ…å« maker_fee_rate, taker_fee_rate
- DataFrame åŒ…å« OHLCV åˆ—ï¼Œç´¢å¼•ä¸º close_time

---

## ğŸš€ å¦‚ä½•ä½¿ç”¨

### 1. åŸºæœ¬ä½¿ç”¨
```python
from wealthai_sdk import get_trading_rule, get_commission_rates

# æŸ¥è¯¢äº¤æ˜“è§„åˆ™
rule = get_trading_rule("binance", "BTCUSDT")
print(f"æœ€å°æ•°é‡: {rule['min_quantity']}")

# æŸ¥è¯¢ä½£é‡‘è´¹ç‡  
fees = get_commission_rates("binance", "BTCUSDT")
print(f"Maker è´¹ç‡: {fees['maker_fee_rate']}")
```

### 2. ç­–ç•¥ä¸­ä½¿ç”¨
```python
def validate_order(broker, symbol, quantity, price):
    rule = get_trading_rule(broker, symbol)
    
    # æ ¡éªŒæ•°é‡
    if quantity < rule["min_quantity"]:
        return False, "æ•°é‡è¿‡å°"
    
    # è°ƒæ•´æ•°é‡ç²¾åº¦
    adjusted_qty = round(quantity, rule["quantity_precision"])
    return True, adjusted_qty
```

### 3. DataFrame è½¬æ¢
```python
from wealthai_sdk import bars_to_dataframe

bars = context.history('BTCUSDT', 20, '1h')
df = bars_to_dataframe(bars)
ma = df['close'].mean()  # è®¡ç®—å‡çº¿
```

---

## ğŸ“ é¡¹ç›®æ–‡ä»¶å˜æ›´

### æ–°å¢æ–‡ä»¶
- `wealthai_sdk/` - å®Œæ•´çš„ SDK æ¨¡å—
- `config/` - é…ç½®æ–‡ä»¶ç›®å½•å’Œç¤ºä¾‹
- `examples/sdk_usage_example.py` - ä½¿ç”¨ç¤ºä¾‹
- `tests/test_wealthai_sdk.py` - å•å…ƒæµ‹è¯•
- `test_sdk.py` - ç®€å•éªŒè¯è„šæœ¬

### ä¿®æ”¹æ–‡ä»¶  
- `setup.py` - æ·»åŠ  pandas ä¾èµ–
- `requirements.txt` - å·²åŒ…å«æ‰€éœ€ä¾èµ–

---

## âœ… éªŒè¯æ–¹æ³•

### 1. è¿è¡Œæµ‹è¯•
```bash
cd "d:/AI Program/wealthai/strategy_spec"
python -m pytest tests/test_wealthai_sdk.py -v
```

### 2. è¿è¡Œç¤ºä¾‹
```bash
python examples/sdk_usage_example.py
```

### 3. å¿«é€ŸéªŒè¯
```bash
python test_sdk.py
```

---

## ğŸ‰ å®æ–½ç»“æœ

### âœ… æˆåŠŸå®ç°äº† OpenSpec è§„èŒƒä¸­çš„æ‰€æœ‰è¦æ±‚
1. **æ¥å£å®Œæ•´æ€§**ï¼šæ‰€æœ‰è§„èŒƒè¦æ±‚çš„æ¥å£éƒ½å·²å®ç°
2. **æ€§èƒ½è¦æ±‚**ï¼šæœ¬åœ°æ–‡ä»¶è¯»å– + ç¼“å­˜æœºåˆ¶
3. **çº¿ç¨‹å®‰å…¨**ï¼šæ”¯æŒå¹¶å‘æŸ¥è¯¢
4. **é”™è¯¯å¤„ç†**ï¼šå®Œæ•´çš„å¼‚å¸¸ä½“ç³»
5. **æ˜“ç”¨æ€§**ï¼šç®€æ´çš„ API è®¾è®¡

### âœ… è¶…å‡ºè§„èŒƒçš„é¢å¤–åŠŸèƒ½
1. **çµæ´»é…ç½®**ï¼šæ”¯æŒå¤šç§é…ç½®ç›®å½•ä¼˜å…ˆçº§
2. **å®Œæ•´æµ‹è¯•**ï¼šå•å…ƒæµ‹è¯•è¦†ç›–æ‰€æœ‰åŠŸèƒ½
3. **è¯¦ç»†æ–‡æ¡£**ï¼šé…ç½®è¯´æ˜å’Œä½¿ç”¨ç¤ºä¾‹
4. **ç±»å‹æç¤º**ï¼šå®Œæ•´çš„ç±»å‹æ³¨è§£

---

## ğŸ”„ åç»­å·¥ä½œå»ºè®®

### 1. å¦‚æœéœ€è¦å½’æ¡£ï¼ˆä½¿ç”¨ `/openspec-archive`ï¼‰
ç”±äºè¿™æ˜¯è§„èŒƒå®ç°è€Œéå˜æ›´ææ¡ˆï¼Œå»ºè®®ï¼š
- åœ¨é¡¹ç›®æ–‡æ¡£ä¸­è®°å½•å®æ–½å®ŒæˆçŠ¶æ€
- æ›´æ–°ç›¸å…³è§„èŒƒçš„å®æ–½çŠ¶æ€æ ‡è®°

### 2. å¦‚æœéœ€è¦æ‰©å±•åŠŸèƒ½
å¯ä»¥ä½¿ç”¨ `/openspec-proposal` åˆ›å»ºæ–°çš„å˜æ›´ææ¡ˆï¼š
- æ·»åŠ æ–°çš„äº¤æ˜“æ‰€æ”¯æŒ
- æ‰©å±•æ•°æ®è½¬æ¢åŠŸèƒ½
- æ·»åŠ æ›´å¤šæŠ€æœ¯æŒ‡æ ‡è®¡ç®—

### 3. é›†æˆåˆ°ç­–ç•¥å¼•æ“
- åœ¨ `engine/` æ¨¡å—ä¸­é›†æˆ wealthai_sdk
- æ›´æ–°ç­–ç•¥æ‰§è¡Œä¸Šä¸‹æ–‡ä»¥ä½¿ç”¨æ–°çš„ SDK

---

## ğŸ“ æŠ€æœ¯æ”¯æŒ

å¦‚æœ‰é—®é¢˜ï¼Œè¯·å‚è€ƒï¼š
- `config/README.md` - é…ç½®æ–‡ä»¶æ ¼å¼è¯´æ˜
- `examples/sdk_usage_example.py` - å®Œæ•´ä½¿ç”¨ç¤ºä¾‹  
- `tests/test_wealthai_sdk.py` - æµ‹è¯•ç”¨ä¾‹å‚è€ƒ

**ğŸ¯ Python SDK å®æ–½å®Œæˆï¼ç°åœ¨å¯ä»¥åœ¨ç­–ç•¥ä¸­ä½¿ç”¨æ‰€æœ‰è§„èŒƒå®šä¹‰çš„æ¥å£äº†ã€‚**