# WebSocket 行情接入 - 快速开始

## 5 分钟快速开始

### 1. 安装依赖

```bash
pip install websocket-client>=1.6.0
```

### 2. 配置并启动（系统级）

```python
from engine.python_sdk.websocket_manager import get_websocket_manager

manager = get_websocket_manager()
manager.configure(
    symbols=["BTCUSDT"],
    resolutions=["1m", "5m", "1h"]
)
manager.start()
```

### 3. 策略使用（无需修改）

```python
from wealthdata import get_price

def handle_bar(context, bar):
    # 自动从 WebSocket 缓存或 Context 获取数据
    df = get_price('BTCUSDT', count=20, frequency='1h')
    print(f"Current price: {df['close'].iloc[-1]}")
```

## 环境变量配置（可选）

```bash
export WEBSOCKET_SYMBOLS="BTCUSDT,ETHUSDT"
export WEBSOCKET_RESOLUTIONS="1m,5m,1h"
```

系统会自动从环境变量读取配置。

## 验证

```python
from engine.python_sdk.websocket_manager import get_websocket_manager

manager = get_websocket_manager()
status = manager.get_status()
print(f"WebSocket state: {status['state']}")
print(f"Subscribed: {status['symbols']}")
```

## 故障排查

如果 WebSocket 连接失败，策略会自动使用 Context 数据，不影响功能。

查看详细文档：
- [README.md](./README.md) - 完整使用指南
- [集成指南.md](./集成指南.md) - 系统集成指南

